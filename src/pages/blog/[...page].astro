---
import type { InferGetStaticPropsType, GetStaticPaths } from 'astro';
import { type CollectionEntry, getCollection } from 'astro:content';
import Base from '../../layouts/Base.astro';
import BlogList from '../../layouts/BlogList.astro';
import { SITE_TITLE, SITE_DESCRIPTION } from '../../consts';
import { sortByDateDesc } from '../../helpers';

type BlogPost = CollectionEntry<'blog'>;

export const getStaticPaths = (async ({ paginate }) => {
	const posts: BlogPost[] = (await getCollection('blog')).sort(sortByDateDesc);
	return paginate(posts, {
		pageSize: 10
	});

}) satisfies GetStaticPaths;

type Props = InferGetStaticPropsType<typeof getStaticPaths>;

const { page } = Astro.props;
const description = SITE_DESCRIPTION + ' Latest posts.';
---

<Base title={SITE_TITLE} {description}>
	<BlogList {page} />
</Base>
